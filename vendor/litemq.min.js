var LiteMQ={version:"<version>",debugMode:!1,utils:{convertToArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)?t:[t]},copy:function(t){return t?JSON.parse(JSON.stringify(t)):t},each:function(t,e,n){t=LiteMQ.convertToArray(t);for(var i=0;t.length>i;i++)e.call(n||null,t[i],i)}},logger:{log:function(t){"undefined"!=typeof console&&console.log&&console.log(t)},debug:function(t,e){LiteMQ.debugMode&&(this.log(["# DEBUG MODE ON","# Bus: "+t.bus.name,"# Origin: "+t.name,"# Event: "+e.eventName,"# Body: "].join("\n")),this.log(e.body),this.log("#########################"))}},convertToArray:function(t){return this.utils.convertToArray(t)},copy:function(t){return this.utils.copy(t)},debug:function(t,e){this.logger.debug(t,e)},each:function(t,e,n){this.utils.each(t,e,n)}};LiteMQ.Bus=o.Class({attach:function(t,e,n){var i=this;LiteMQ.each(t,function(t){i._addEventListener(t,[e,n])})},clear:function(){this._resetListeners()},detach:function(t,e,n){var i=this;t?LiteMQ.each(t,function(t){n?i._detachListener(t,e,n):i._detachEvent(t,e)}):this._detachAll(e)},init:function(t){this._super(t),this._listeners={}},trigger:function(t,e,n){var i=this;LiteMQ.each(t,function(t){var s={origin:e.name,eventName:t,body:LiteMQ.copy(n)};LiteMQ.debug(e,s),i._filterEventListener(t,function(t,n){try{return t!==e&&n.call(t,s),!0}catch(i){console.log(i)}})})},_addEventListener:function(t,e){var n=this._getEventListeners(t);n.push(e)},_detachAll:function(t){var e=this._getListeners();for(var n in e)this._detachEvent(n,t)},_detachEvent:function(t,e){this._filterEventListener(t,function(t){return e!==t?!0:void 0})},_detachListener:function(t,e,n){this._filterEventListener(t,function(t,i){return e!==t||n!==i?!0:void 0})},_filterEventListener:function(t,e){var n=this._getEventListeners(t),i=[];LiteMQ.each(n,function(t){e(t[0],t[1])&&i.push([t[0],t[1]])}),this._setEventListeners(t,i)},_getEventListeners:function(t){var e=this._listeners[t]||[];return this._setEventListeners(t,e),this._listeners[t]},_getListeners:function(){return this._listeners},_setEventListeners:function(t,e){this._listeners[t]=e},_resetListeners:function(){this._listeners={}}}),LiteMQ.DefaultBus=new LiteMQ.Bus({name:"DefaultBus"}),LiteMQ.Client=o.Class({disable:function(t){var e=this;LiteMQ.each(this.listeners,function(n){n.enabled&&(n.evt!==t&&t||(n.enabled=!1,e._detach(n.evt,n.fn)))})},enable:function(t){var e=this;LiteMQ.each(this.listeners,function(n){n.enabled||n.evt!==t&&t||(n.enabled=!0,e._attach(n.evt,n.fn))})},init:function(t){this.bus=LiteMQ.DefaultBus,this.name="anonymous",this._super(t),this.listeners=[]},pub:function(t,e){return this.bus.trigger(t,this,e),this},sub:function(t,e){var n=this;return LiteMQ.each(t,function(t){n._attach(t,e),n.listeners.push({evt:t,fn:e,enabled:!0})}),this},unsub:function(t,e){return this._detach(t,e),this},_attach:function(t,e){this.bus.attach(t,this,e)},_detach:function(t,e){this.bus.detach(t,this,e)}});